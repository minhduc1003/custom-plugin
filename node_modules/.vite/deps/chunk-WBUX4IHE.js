import {
  c,
  h
} from "./chunk-5NYYS2XH.js";
import {
  E7,
  Fs,
  H0,
  M2,
  N,
  N11,
  QU1,
  T2,
  VS,
  Vr,
  _,
  ao,
  b0,
  d,
  de,
  gB1,
  gM,
  h1,
  hB1,
  ka,
  nc,
  p1,
  s2e,
  t2,
  uU1,
  vo
} from "./chunk-C4ZQG65I.js";
import {
  require_react_dom
} from "./chunk-VGGCA2L5.js";
import {
  require_react
} from "./chunk-73THXJN7.js";
import {
  __toESM
} from "./chunk-2TUXWMP5.js";

// node_modules/lowcoder-sdk/dist/91f867d0.js
var import_react = __toESM(require_react(), 1);
var import_react_dom = __toESM(require_react_dom(), 1);
function ae(e, o) {
  o === void 0 && (o = 0);
  var r = (0, import_react.useRef)(false), a = (0, import_react.useRef)(), l = (0, import_react.useRef)(e), h2 = (0, import_react.useCallback)(function() {
    return r.current;
  }, []), c2 = (0, import_react.useCallback)(function() {
    r.current = false, a.current && clearTimeout(a.current), a.current = setTimeout(function() {
      r.current = true, l.current();
    }, o);
  }, [o]), u = (0, import_react.useCallback)(function() {
    r.current = null, a.current && clearTimeout(a.current);
  }, []);
  return (0, import_react.useEffect)(function() {
    l.current = e;
  }, [e]), (0, import_react.useEffect)(function() {
    return c2(), u;
  }, [o]), [h2, u, c2];
}
function ie(e, o, r) {
  o === void 0 && (o = 0), r === void 0 && (r = []);
  var a = ae(e, o), l = a[0], h2 = a[1], c2 = a[2];
  return (0, import_react.useEffect)(c2, r), [l, h2];
}
var D = T2`
  & .ql-snow {
    .ql-picker.ql-header {
      .ql-picker-label::before,
      .ql-picker-item::before {
        content: "${_("richTextEditor.content")}";
      }

      .ql-picker-label[data-value="1"]::before,
      .ql-picker-item[data-value="1"]::before {
        content: "${_("richTextEditor.title")} 1";
      }

      .ql-picker-label[data-value="2"]::before,
      .ql-picker-item[data-value="2"]::before {
        content: "${_("richTextEditor.title")} 2";
      }

      .ql-picker-label[data-value="3"]::before,
      .ql-picker-item[data-value="3"]::before {
        content: "${_("richTextEditor.title")} 3";
      }

      .ql-picker-item[data-value="1"]::before {
        font-size: 26px;
      }

      .ql-picker-item[data-value="3"]::before {
        font-size: 19px;
      }

      .ql-picker-item[data-value="3"]::before {
        font-size: 15px;
      }
    }
    & .ql-tooltip.ql-editing a.ql-action::after {
      content: "${_("richTextEditor.save")}";
    }
    & .ql-tooltip::before {
      content: "${_("richTextEditor.link")}";
    }
    & .ql-tooltip {
      a.ql-action::after {
        content: "${_("richTextEditor.edit")}";
      }
      a.ql-remove::before {
        content: "${_("richTextEditor.remove")}";
      }
    }
  }
`;
var P = (e) => T2`
  height: 100%;

  & .ql-editor {
    min-height: 85px;
  }
  & .ql-snow .ql-tooltip.ql-editing {
    input[type="text"] {
      width: 130px;
    }
  }
  & .ql-snow {
    &.ql-container,
    &.ql-toolbar {
      border-color: ${e.border};
      background-color: ${e.background};
      
    }
  }
  & .ql-toolbar {
    border-radius: ${e.radius} ${e.radius} 0 0;
    border-width: ${e.borderWidth ? e.borderWidth : "1px"};
  }
  & .ql-container {
    border-radius: 0 0 ${e.radius} ${e.radius};
    background-color: ${e.background};
    border-width: ${e.borderWidth ? e.borderWidth : "1px"};
  }
`;
var F = (e) => T2`
  .ql-snow.ql-toolbar {
    height: 0;
    overflow: hidden;
    padding: 0;
    border-bottom: 0;
    border: none;
  }
  .quill .ql-snow.ql-container {
    border-radius: ${e.radius};
    border: 1px solid ${e.border};
  }
`;
var ne = de.div`
  ${D}
  ${(e) => P(e.$style)}
  & .ql-container .ql-editor {
    min-height: 125px;
  }
  ${(e) => e.$hideToolbar ? F(e.$style) : ""};
`;
var le = de.div`
  ${D}
  ${(e) => P(e.$style)}
  & .quill {
    display: flex;
    flex-direction: column;
    height: 100%;
  }
  & .ql-snow {
    &.ql-container {
      flex: 1;
      overflow: auto;
    }
  }
  ${(e) => e.$hideToolbar ? F(e.$style) : ""};
`;
var ce = [[{
  header: [1, 2, 3, false]
}], ["bold", "italic", "underline", "strike", "blockquote"], [{
  list: "ordered"
}, {
  list: "bullet"
}], [{
  indent: "-1"
}, {
  indent: "+1"
}], [{
  color: []
}, {
  background: []
}, {
  align: []
}], ["link", "image"], ["clean"]];
var de2 = {
  value: QU1("value"),
  hideToolbar: ao,
  readOnly: ao,
  autoHeight: t2(gM, "fixed"),
  placeholder: t2(M2, _("richTextEditor.placeholder")),
  toolbar: t2(M2, JSON.stringify(ce)),
  onEvent: N11,
  style: nc(uU1, "style"),
  ...c
};
var ue = import_react.default.lazy(() => import("./08fa5cf1-K5Y7UQSD.js").then((e) => e.i));
function se(e) {
  const [o, r] = (0, import_react.useState)(0), [a, l] = (0, import_react.useState)(""), h2 = (0, import_react.useRef)(null), c2 = (0, import_react.useRef)(null), u = (0, import_react.useRef)(0), f = (0, import_react.useRef)(e.onChange);
  f.current = e.onChange;
  const N2 = (0, import_react.useRef)(h1.debounce((i) => {
    var s;
    window.clearTimeout(u.current), u.current = window.setTimeout(() => u.current = 0, 100), (s = f.current) == null || s.call(f, i);
  }));
  ie(() => {
    r(Math.random());
  }, 500, [e.placeholder]);
  const W = (i, s) => {
    try {
      s.parentNode;
    } catch {
      return false;
    }
    return i.contains(s);
  }, z = (i) => {
    l(i), N2.current(i);
  };
  (0, import_react.useEffect)(() => {
    let i = e.value;
    /^<\w+>.+<\/\w+>$/.test(e.value) || (i = `<p class="">${e.value}</p>`), l(i);
  }, [e.value]);
  const A = (i) => {
    var m, p;
    (p = ((m = c2.current) == null ? void 0 : m.editor).theme.pickers) == null || p.forEach((E) => {
      W(E.container, i.nativeEvent.target) || E.close();
    });
  }, $ = "rtf-editor", B = e.autoHeight ? ne : le;
  return d(B, {
    id: $,
    onClick: A,
    ref: h2,
    $hideToolbar: e.hideToolbar,
    $style: e.$style,
    children: d(import_react.Suspense, {
      fallback: d(Fs, {}),
      children: d(ue, {
        ref: c2,
        bounds: `#${$}`,
        modules: {
          toolbar: JSON.parse(e.toolbar)
        },
        theme: "snow",
        value: a,
        placeholder: e.placeholder,
        readOnly: e.readOnly,
        onChange: z
      }, o)
    })
  });
}
var he = new VS(de2, (e) => {
  const o = (r) => {
    e.value.onChange(r), e.onEvent("change");
  };
  return d(se, {
    autoHeight: e.autoHeight,
    hideToolbar: e.hideToolbar,
    toolbar: e.toolbar,
    readOnly: e.readOnly,
    value: e.value.value,
    placeholder: e.placeholder,
    onChange: o,
    $style: e.style
  });
}).setPropertyViewFn((e) => N(p1, {
  children: [N(ka, {
    name: b0.basic,
    children: [e.value.propertyView({
      label: _("richTextEditor.defaultValue")
    }), hB1(e)]
  }), d(h, {
    ...e
  }), ["logic", "both"].includes((0, import_react.useContext)(Vr).editorModeStatus) && N(ka, {
    name: b0.interaction,
    children: [e.onEvent.getPropertyView(), E7(e), gB1(e)]
  }), ["layout", "both"].includes((0, import_react.useContext)(Vr).editorModeStatus) && N(p1, {
    children: [N(ka, {
      name: b0.layout,
      children: [e.autoHeight.getPropertyView(), e.toolbar.propertyView({
        label: _("richTextEditor.toolbar"),
        tooltip: _("richTextEditor.toolbarDescription")
      }), e.hideToolbar.propertyView({
        label: _("richTextEditor.hideToolbar")
      })]
    }), d(ka, {
      name: b0.style,
      children: e.style.getPropertyView()
    })]
  })]
})).build();
var be = class extends he {
  autoHeight() {
    return this.children.autoHeight.getView();
  }
};
var me = H0(be, [new vo("value", _("export.richTextEditorValueDesc")), new vo("readOnly", _("export.richTextEditorReadOnlyDesc")), new vo("hideToolbar", _("export.richTextEditorHideToolBarDesc")), s2e]);

export {
  me
};
//# sourceMappingURL=chunk-WBUX4IHE.js.map
