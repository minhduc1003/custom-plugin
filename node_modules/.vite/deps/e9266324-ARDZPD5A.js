import {
  Nr
} from "./chunk-OAJO6J3Z.js";
import "./chunk-OLYZGCEV.js";
import "./chunk-4PJIDOQH.js";
import "./chunk-MOB4AT22.js";
import "./chunk-SE4HJ52Z.js";
import "./chunk-5DFQCACC.js";
import "./chunk-S6RHOSBF.js";
import "./chunk-I3BFBHFD.js";
import "./chunk-JF3EZIPA.js";
import "./chunk-ZFHHPBHY.js";
import "./chunk-GLXBN3BV.js";
import "./chunk-WH4AAS5L.js";
import "./chunk-L2S6LEVF.js";
import "./chunk-LMPYD5GA.js";
import "./chunk-TOSPXHGB.js";
import "./chunk-WVQJ2E2E.js";
import "./chunk-CANFQLQO.js";
import "./chunk-OBIVADBV.js";
import "./chunk-X2VRMNBQ.js";
import "./chunk-KEAKMKX3.js";
import "./chunk-ONX6OGPV.js";
import "./chunk-PPFZ32FN.js";
import "./chunk-JWNUD2I7.js";
import "./chunk-J4RAP5UY.js";
import "./chunk-FE7RME4P.js";
import "./chunk-HFCYJ36P.js";
import "./chunk-XDW5KDN5.js";
import "./chunk-KGKG6FTU.js";
import "./chunk-XDFSSJQ7.js";
import "./chunk-UZRRIV26.js";
import "./chunk-LO3KA2SO.js";
import "./chunk-OK47LCRW.js";
import "./chunk-OQKE4CKD.js";
import "./chunk-EYLBC2ZA.js";
import "./chunk-MLFJ4O3P.js";
import "./chunk-F2O4R2OP.js";
import "./chunk-4WXWJGVM.js";
import "./chunk-LVMNH547.js";
import "./chunk-OS4MOUVU.js";
import "./chunk-MUYASK6Q.js";
import "./chunk-TOV2UHZV.js";
import "./chunk-FNADJP5Z.js";
import "./chunk-YNPT42JB.js";
import "./chunk-NA3WZCBS.js";
import "./chunk-TYIEFT45.js";
import "./chunk-A73J3BH2.js";
import "./chunk-7DG7FGWN.js";
import "./chunk-YHMTP5SQ.js";
import "./chunk-MHBIPDGL.js";
import "./chunk-PVTBHE2Q.js";
import "./chunk-JM3TVKPY.js";
import "./chunk-FBSDHPXE.js";
import "./chunk-SCZNWIII.js";
import "./chunk-GAGBQ5H3.js";
import "./chunk-NHSDYLI7.js";
import "./chunk-PZ2QAXW6.js";
import "./chunk-SEWNL2M2.js";
import "./chunk-2ZTEB2N7.js";
import "./chunk-NWL2LKPD.js";
import "./chunk-6GCGVRH5.js";
import "./chunk-JHLVXI66.js";
import "./chunk-NFFAU32G.js";
import "./chunk-ASSQVYPX.js";
import "./chunk-N6GHBDCY.js";
import "./chunk-AXUQWSIE.js";
import "./chunk-JAILEAXE.js";
import "./chunk-WJDB5KYS.js";
import "./chunk-CVAATRKD.js";
import "./chunk-WXT6MRKI.js";
import "./chunk-L63JEYDN.js";
import "./chunk-ROS5BPIE.js";
import "./chunk-L237NUKP.js";
import "./chunk-LGOCZWWP.js";
import "./chunk-5TTKJPVI.js";
import "./chunk-2WCVLA62.js";
import "./chunk-2NK27OYZ.js";
import "./chunk-RKGH4KYG.js";
import "./chunk-VZ5HYFWM.js";
import "./chunk-GVR6SMOX.js";
import "./chunk-HH257QPH.js";
import "./chunk-J35SZZWO.js";
import "./chunk-OLUJ7YB4.js";
import "./chunk-IMATYS3Y.js";
import "./chunk-RZDMZZLI.js";
import "./chunk-2SQRRBMF.js";
import "./chunk-7APN3IET.js";
import "./chunk-HSEH3VVW.js";
import "./chunk-QLNMZPUP.js";
import "./chunk-Z2KNLIQY.js";
import "./chunk-N55PIOUB.js";
import "./chunk-BKGZLFRE.js";
import "./chunk-3VMUCLWM.js";
import "./chunk-LQRJKPBR.js";
import "./chunk-P5ARDIOU.js";
import "./chunk-HNNKGNYR.js";
import "./chunk-4BYNWI2L.js";
import "./chunk-CM7HFHB5.js";
import "./chunk-GENSJFPI.js";
import "./chunk-UCKZF5HB.js";
import "./chunk-ZGZCCICL.js";
import "./chunk-ZIGUSEHP.js";
import "./chunk-LYIEK64M.js";
import "./chunk-5HTQQ5EI.js";
import "./chunk-SCDBHG4W.js";
import "./chunk-WBUX4IHE.js";
import "./chunk-XSKHF64U.js";
import "./chunk-VWBEUK5Z.js";
import "./chunk-JLUQ2J2P.js";
import "./chunk-WA2SYFWS.js";
import "./chunk-ZOCROSNT.js";
import "./chunk-UVQUU2LB.js";
import "./chunk-CBPDSAUT.js";
import "./chunk-43DHTA6P.js";
import "./chunk-QEGXW5PS.js";
import "./chunk-DOUBMFJR.js";
import "./chunk-ARF62KDN.js";
import "./chunk-ZTHRNQ6B.js";
import "./chunk-E6PYDUMC.js";
import "./chunk-LIXEFCIV.js";
import "./chunk-ORRWBCWV.js";
import "./chunk-7VBHG5SW.js";
import "./chunk-OQHOLJQO.js";
import "./chunk-AEJZYG5D.js";
import "./chunk-WRBTKELO.js";
import "./chunk-QLOEH37K.js";
import "./chunk-5NYYS2XH.js";
import "./chunk-X2WK2QYD.js";
import "./chunk-CVL2DCJG.js";
import "./chunk-MZOHA253.js";
import "./chunk-ANFJG6VM.js";
import "./chunk-VMHS7O5Q.js";
import "./chunk-6T4XWR7Q.js";
import "./chunk-WN2SCILO.js";
import "./chunk-NLQXG5KG.js";
import "./chunk-WECP47J3.js";
import "./chunk-5IDL2XJN.js";
import "./chunk-FYLWZ24G.js";
import "./chunk-N6JPU3M6.js";
import "./chunk-GHJN7PYO.js";
import "./chunk-FSYZPGRH.js";
import "./chunk-TXZY2D3Y.js";
import "./chunk-MBEFDR55.js";
import "./chunk-LJDXVAHL.js";
import "./chunk-YFOH62AH.js";
import "./chunk-YTIIQKGY.js";
import "./chunk-YZDWOT2R.js";
import "./chunk-HQSD33ZW.js";
import "./chunk-BUWBPYPE.js";
import {
  D6e,
  I6e,
  Ih,
  J2e,
  JJ,
  W8,
  _n,
  gc
} from "./chunk-C4ZQG65I.js";
import {
  require_react_dom
} from "./chunk-VGGCA2L5.js";
import {
  require_react
} from "./chunk-73THXJN7.js";
import {
  __toESM
} from "./chunk-2TUXWMP5.js";

// node_modules/lowcoder-sdk/dist/e9266324.js
var import_react = __toESM(require_react(), 1);
var import_react_dom = __toESM(require_react_dom(), 1);
var T = {
  ui: {
    items: {
      "2e2d4bf2": {
        compType: "module",
        comp: {
          appId: "123",
          events: [{
            name: "event1",
            handler: {
              compType: "executeComp",
              comp: {
                name: "outerInput",
                methodName: "setValue",
                params: [{
                  compType: "string",
                  comp: "event1_triggered",
                  name: "value"
                }]
              }
            }
          }]
        },
        name: "module1"
      },
      "2bb084bf": {
        compType: "input",
        comp: {
          value: ""
        },
        name: "outerInput"
      }
    }
  },
  queries: [{
    compType: "js",
    comp: {
      script: "return 3;"
    },
    id: "dievziawwqy72gszoa42i6m8",
    name: "jsQuery3",
    triggerType: "manual"
  }, {
    compType: "js",
    comp: {
      script: "return 3 + a;"
    },
    id: "dievziawwqy72gszoa42i6m9",
    name: "jsQuery4",
    triggerType: "manual"
  }]
};
var f = {
  ui: {
    compType: "module",
    comp: {
      methods: [{
        name: "method1",
        action: {
          compType: "executeComp",
          comp: {
            name: "input1",
            methodName: "setValue",
            params: [{
              compType: "string",
              comp: "hello method1",
              name: "value"
            }]
          }
        }
      }, {
        name: "method2",
        params: [{
          name: "param1",
          type: "string"
        }],
        action: {
          compType: "executeComp",
          comp: {
            name: "input1",
            methodName: "setValue",
            params: [{
              compType: "string",
              comp: "hello {{param1}}",
              name: "value"
            }]
          }
        }
      }],
      events: {
        list: [{
          name: "event1",
          description: ""
        }, {
          name: "event2",
          description: ""
        }],
        onEvent: [{
          name: "event1",
          handler: {
            compType: "executeComp",
            comp: {
              name: "input1",
              methodName: "setValue",
              params: [{
                compType: "string",
                comp: "from_event1",
                name: "value"
              }]
            }
          }
        }]
      },
      io: {
        inputs: [{
          name: "inQuery",
          description: "",
          type: "query"
        }, {
          name: "inNum",
          description: "",
          type: "number"
        }, {
          name: "inString",
          description: "",
          type: "string",
          defaultValue: {
            compType: "string",
            comp: "default_value"
          },
          test: {
            compType: "string",
            comp: "test_value"
          }
        }],
        outputs: [{
          description: "",
          value: "{{input1.value}}",
          name: "out"
        }]
      },
      containerSize: {
        height: 20,
        width: 24
      },
      container: {
        items: {
          "2010af2a": {
            compType: "input",
            comp: {
              value: "hello"
            },
            name: "input1"
          },
          e97d3df7: {
            compType: "text",
            comp: {
              text: "inNum:{{inNum.value}}"
            },
            name: "text1"
          },
          e97d3df8: {
            compType: "text",
            comp: {
              text: "inString:{{inString.value}}"
            },
            name: "text2"
          },
          e97d3df9: {
            compType: "text",
            comp: {
              text: "inQueryData:{{inQuery.data}}"
            },
            name: "text3"
          }
        }
      }
    }
  },
  queries: [{
    compType: "js",
    comp: {
      script: "return 1 + 1"
    },
    id: "dievziawwqy72gszoa42i6m7",
    name: "jsQuery",
    triggerType: "manual",
    onEvent: [{
      name: "success",
      handler: {
        compType: "executeComp",
        comp: {
          name: "input1",
          methodName: "setValue",
          params: [{
            compType: "string",
            comp: "hello success",
            name: "value"
          }]
        }
      }
    }]
  }, {
    compType: "js",
    comp: {
      script: `inQuery.run({a: 10}); 
input1.setValue('hello input query'); return 'ok'`
    },
    id: "dievziawwqy72gszoa42i6m8",
    name: "jsQuery2",
    triggerType: "manual"
  }, {
    compType: "js",
    comp: {
      script: "event1.trigger();"
    },
    id: "dievziawwqy72gszoa42i6m9",
    name: "jsQuery3",
    triggerType: "manual"
  }]
};
function r(o) {
  const e = D6e({
    Comp: I6e,
    initialValue: T,
    reduceContext: {
      readOnly: false,
      applicationId: "123",
      moduleDSL: {
        123: f
      },
      parentApplicationPath: []
    }
  });
  if (!e)
    throw new Error();
  const t = (a, s) => a.children.ui.getAllCompItems()[s].children.comp, i = (a) => t(e.comp, a), p = () => i("2e2d4bf2"), m = (a) => {
    const l = p().moduleRootComp;
    return t(l, a);
  };
  e.init().then(() => {
    p().dispatch(_n({
      type: "init"
    }, false)), setTimeout(() => {
      o({
        root: () => e.comp,
        moduleRoot: () => p().moduleRootComp,
        module: p,
        moduleOutputNodes: () => p().getOutputNodes(),
        input: () => m("2010af2a"),
        inputValue: () => m("2010af2a").children.value.getView().value,
        text1: () => m("e97d3df7"),
        text2: () => m("e97d3df8"),
        text3: () => m("e97d3df9"),
        outerInputValue: () => i("2bb084bf").children.value.getView().value
      });
    });
  });
}
beforeAll(async () => {
  await Nr();
});
describe("module comp", () => {
  test("init module to ready", (o) => {
    r(({
      module: e,
      text1: t,
      text2: i
    }) => {
      expect(Object.keys(e().getOutputNodes())).toStrictEqual(["out"]), expect(e().exposingValues.out).toBe("hello"), expect(Object.keys(e().children.inputs.getInputNodes())).toStrictEqual([]), expect(t().children.text.getView().value).toBe("inNum:"), e().children.inputs.children.inNum.dispatchChangeValueAction(1), expect(t().children.text.getView().value).toBe("inNum:1"), expect(Object.keys(e().children.inputs.getInputNodes())).toStrictEqual(["inNum"]), expect(i().children.text.getView().value).toBe("inString:default_value"), e().children.inputs.children.inString.dispatchChangeValueAction("hello"), expect(i().children.text.getView().value).toBe("inString:hello"), expect(Object.keys(e().children.inputs.getInputNodes())).toStrictEqual(["inNum", "inString"]), o();
    });
  }), test("change value in module", (o) => {
    r(({
      input: e,
      inputValue: t
    }) => {
      expect(t()).toBe("hello"), e().children.value.dispatchChangeValueAction("world"), expect(t()).toBe("world"), gc(e().children.value.dispatch, e().children.value.changeValueAction("hello world"), {
        autoHandleAfterReduce: true
      }).then(() => {
        expect(t()).toBe("hello world"), o();
      });
    });
  }), test("exec query in module", (o) => {
    r(({
      moduleRoot: e,
      module: t,
      inputValue: i
    }) => {
      expect(t().exposingValues.out).toBe("hello"), e().dispatch(Ih("jsQuery", W8({}))), setTimeout(() => {
        expect(i()).toBe("hello success"), expect(t().exposingValues.out).toBe("hello success"), o();
      }, 300);
    });
  }), test("input query data", (o) => {
    r(({
      text3: e,
      module: t,
      root: i,
      inputValue: p
    }) => {
      expect(e().children.text.getView().value).toBe("inQueryData:"), t().children.inputs.children.inQuery.dispatchChangeValueAction({
        value: "jsQuery3"
      }), expect(Object.keys(t().children.inputs.getInputNodes())).toStrictEqual(["inQuery"]), expect(e().children.text.getView().value).toBe("inQueryData:"), i().dispatch(Ih("jsQuery3", W8({}))), setTimeout(() => {
        expect(e().children.text.getView().value).toBe("inQueryData:3"), o();
      }, 1e3);
    });
  }), test("exec input query", (o) => {
    r(({
      text3: e,
      module: t,
      moduleRoot: i,
      inputValue: p
    }) => {
      expect(e().children.text.getView().value).toBe("inQueryData:"), t().children.inputs.children.inQuery.dispatchChangeValueAction({
        value: "jsQuery4"
      }), expect(Object.keys(t().children.inputs.getInputNodes())).toStrictEqual(["inQuery"]), expect(e().children.text.getView().value).toBe("inQueryData:"), i().dispatch(Ih("jsQuery2", W8({}))), setTimeout(() => {
        expect(p()).toBe("hello input query"), expect(e().children.text.getView().value).toBe("inQueryData:13"), o();
      }, 1e3);
    });
  }), test("exec methods", (o) => {
    r(({
      root: e,
      inputValue: t
    }) => {
      const i = e().nameAndExposingInfo();
      expect(Object.keys(i.module1.methods)).toStrictEqual(["method1", "method2"]), e().dispatch(Ih("module1", _n({
        type: "execute",
        methodName: "method1",
        params: []
      }, false))), setTimeout(() => {
        expect(t()).toBe("hello method1"), o();
      }, 2e3);
    });
  }), test("exec methods with params", (o) => {
    r(({
      root: e,
      inputValue: t
    }) => {
      const i = e().nameAndExposingInfo();
      expect(Object.keys(i.module1.methods)).toStrictEqual(["method1", "method2"]), e().dispatch(Ih("module1", _n({
        type: "execute",
        methodName: "method2",
        params: ["Lucy"]
      }, false))), setTimeout(() => {
        expect(t()).toBe("hello Lucy"), o();
      }, 2e3);
    });
  }), test("trigger events by event", (o) => {
    r(({
      root: e,
      text3: t,
      module: i,
      moduleRoot: p,
      outerInputValue: m
    }) => {
      expect(m()).toBe(""), p().dispatch(Ih(J2e, JJ("event1"))), setTimeout(() => {
        expect(m()).toBe("event1_triggered"), o();
      });
    });
  }), test("trigger events by js query", (o) => {
    r(({
      root: e,
      text3: t,
      module: i,
      moduleRoot: p,
      outerInputValue: m
    }) => {
      expect(m()).toBe(""), p().dispatch(Ih("jsQuery3", W8({}))), setTimeout(() => {
        expect(m()).toBe("event1_triggered"), o();
      }, 1e3);
    });
  });
});
//# sourceMappingURL=e9266324-ARDZPD5A.js.map
